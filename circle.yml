machine:
  python:
    version: 2.7.9
dependencies:
  pre:
    - sudo apt-get install python-pip python-dev git curl
    # Install Ansible.
    - pip install ansible==2.2.1.0
    - pip install -r requirements.txt
    - ansible-galaxy install --ignore-errors geerlingguy.apache
  post:

test:
  override:
    - ansible-playbook --syntax-check --extra-vars="server_hostname=web3 linode_plan=1" provision-server.yml
    - ansible-playbook --syntax-check -i "web3.thunderbird.net,web4.thunderbird.net" --extra-vars var_hosts=all setup-webheads.yml
    - python build_production.py
    - python lino.py listnodes
    - python lino.py forcedelete web3 web4

